package com.malwaredetection.app.mapper;

import com.malwaredetection.app.controller.response.DetectionMessageResponse;
import com.malwaredetection.app.dto.DetectionDTO;
import com.malwaredetection.app.dto.DeviceDTO;
import com.malwaredetection.app.repository.entity.Detection;
import com.malwaredetection.app.repository.entity.Device;
import org.springframework.stereotype.Component;

import java.sql.Timestamp;
import java.time.Instant;
import java.util.Date;

@Component
public class CustomMapper {
    public Detection dtoToEntity(DetectionDTO detectionDTO) {
        return Detection.builder()
                .detectionID(detectionDTO.getDetectionID())
                .time(Timestamp.from(Instant.now()))
                .nameOfApp(detectionDTO.getNameOfApp())
                .typeOfApp(detectionDTO.getTypeOfApp())
                .type(detectionDTO.getType())
                .build();

    }

    public Device dtoToEntity(DeviceDTO deviceDTO) {
        return Device.builder()
                .deviceUID(deviceDTO.getDeviceUID())
                .deviceModel(deviceDTO.getDeviceModel())
                .deviceType(deviceDTO.getDeviceType())
                .osVersion(deviceDTO.getOsVersion())
                .build();
    }

    public DetectionMessageResponse entityToMessageResponse(Detection detection) {
        return DetectionMessageResponse.builder()
                .deviceUID(detection.getDevice().getDeviceUID())
                .deviceType(detection.getDevice().getDeviceType())
                .time(Date.from(detection.getTime().toInstant()))
                .nameOfApp(detection.getNameOfApp())
                .type(detection.getType())
                .build();
    }
}
